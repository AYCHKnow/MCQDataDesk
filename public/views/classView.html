<script src="../controllers/classViewController.js"></script>

<div id="classContainer" ng-controller="classViewCtrl">
    <nav class="navbar navbar-masthead navbar-default" style="margin-bottom:0">
        <div class="container-fluid" style="padding-left:0">
            <div class="collapse navbar-collapse bs-example-masthead-collapse-1">
                <!-- Left Elements -->
                <ul class="nav navbar-nav">
                    <li class="active"><a class="navbar-brand">{{ class.courseID }}</a></li>
                    <li><a href="#" ng-click="goBack()">Course Selection</a></li>
                    <li><a href="#" ng-click="about()">About</a></li>
                </ul>
                <!-- Right Elements -->
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown" uib-dropdown>
                        <a href="#" class="dropdown-toggle" uib-dropdown-toggle>Tools <span class="caret"></span></a>
                        <ul class="dropdown-menu" uib-dropdown-menu>
                            <li><a href="#" ng-click="importQuestions()">Import Questions</a></li>
                            <li><a href="#" ng-click="exportAssessment()">Export Assessment</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="#" ng-click="deleteQuestions()">Delete Multiple Questions</a></li>
                            <li role="separator" class="divider"></li>
                            <li tooltip-placement="left" uib-tooltip="Use this if the questions listed under specific objectives are wrong (or acting funny).">
                                <a href="#" ng-click="repairObjectives()">Repair Objective Relationships</a>
                            </li>
                        </ul>
                    </li>
                    <li tooltip-placement="bottom" uib-tooltip="Nothing here yet!"><a href="#">Settings</a></li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>

    <md-content>
        <md-tabs md-autoselect md-dynamic-height md-border-bottom>
            <md-tab label="Overview">
                <div autoscroll="130">
                    <md-content class="md-padding greyBackground" layout="column" layout-gt-sm="row">

                        <uib-tabset justified="true">
                            <!-- Assessments Tab -->
                            <uib-tab index="0" context-menu="assessmentsHeading">
                                <uib-tab-heading>
                                    Assessments  ({{ class.assessments.length }})
                                </uib-tab-heading>

                                <div class="tab-pane" style="padding:5px;background:white;border:1px solid #ddd;border-top-color:white;border-radius:0 0 4px 4px">
                                    <div class="container-fluid" style="padding-bottom:5px">
                                        <div id="assessmentFloatingButtons" style="padding-bottom:5px;">
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-primary" ng-click="createAssessment()">Create New</button>
                                                <button type="button" class="btn btn-default" ng-disabled="!class.assessments.length" ng-click="iterateAccordion(assessmentOpen,true,class.assessments.length)">Expand All</button>
                                                <button type="button" class="btn btn-default" ng-disabled="!class.assessments.length" ng-click="iterateAccordion(assessmentOpen,false,class.assessments.length)">Collapse All</button>
                                            </div>

                                            <div class="btn-group btn-group-sm" style="float:right;position:relative;top:6px">
                                                <button type="button" class="btn btn-default" data-toggle="button" tooltip-placement="left"
                                                        uib-tooltip="{{ 'Sort By: '+assessmentsSort.name }}" ng-click="incrementSortMode('assessmentsSort')">
                                                    <span class="glyphicon {{assessmentsSort.icon}}"></span>
                                                </button>
                                                <button type="button" class="btn btn-default" data-toggle="button"
                                                        tooltip-placement="top" uib-tooltip="Filter" ng-click="assessmentsFilter.open = !assessmentsFilter.open">
                                                    <span class="glyphicon glyphicon-filter"></span>
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Filter Dropdown -->
                                        <div ng-if="assessmentsFilter.open">
                                            <div style="padding: 5px;background-color:#e7e7e7;border:1px solid rgb(205, 205, 205);display:inline-flex">
                                                <div class="input-group" style="width:65%;margin-right:2px">
                                                    <input type="text" class="form-control" placeholder="Filter Assessments" ng-model="assessmentsFilter.query">
                                                    <span class="input-group-addon">
                                                            <label>
                                                                <input type="checkbox" ng-model="assessmentsFilter.searchNames" style="position:relative;top:2px"/>
                                                                Search Names
                                                            </label>

                                                            <label>
                                                                <input type="checkbox" ng-model="assessmentsFilter.searchDescriptions" style="position:relative;top:2px"/>
                                                                Search Descriptions
                                                            </label>

                                                            <label>
                                                                <input type="checkbox" ng-model="assessmentsFilter.searchQuestions" style="position:relative;top:2px"/>
                                                                Search Questions
                                                            </label>

                                                            <label>
                                                                <input type="checkbox" ng-model="assessmentsFilter.caseSensitive" style="position:relative;top:2px"/>
                                                                Case Sensitive
                                                            </label>
                                                        </span>
                                                </div>
                                                <div style="width:35%; display:inherit">
                                                    <div class="input-group" style="width:50%;margin-right:2px">
                                                        <ui-select allow-clear ng-model="assessmentsFilter.topicQuery" theme="bootstrap">
                                                            <ui-select-match placeholder="Filter Topic">
                                                                {{$select.selected.topicName}}
                                                            </ui-select-match>
                                                            <ui-select-choices repeat="topic in class.topics | filter: { topicName: $select.search }">
                                                                <div ng-bind-html="topic.topicName | highlight: $select.search"></div>
                                                                <small class="text-muted" ng-bind-html="topic.topicDescription"></small>
                                                            </ui-select-choices>
                                                        </ui-select>
                                                        <span class="input-group-btn">
                                                              <button type="button" ng-click="assessmentsFilter.topicQuery = undefined" class="btn btn-default" ng-disabled="!assessmentsFilter.topicQuery">
                                                                <span class="glyphicon glyphicon-remove"></span>
                                                              </button>
                                                            </span>
                                                    </div>
                                                    <div class="input-group" style="width:50%">
                                                        <ui-select ng-model="assessmentsFilter.objectiveQuery" theme="bootstrap" ng-disabled="!class.objectives.length">
                                                            <ui-select-match placeholder="Filter Objective">
                                                                {{$select.selected.objectiveText}}
                                                            </ui-select-match>
                                                            <ui-select-choices repeat="objective in class.objectives | filter: { objectiveText: $select.search }">
                                                                <span ng-bind-html="objective.objectiveText | highlight: $select.search"></span>
                                                            </ui-select-choices>
                                                        </ui-select>
                                                        <span class="input-group-btn">
                                                              <button type="button" ng-click="assessmentsFilter.objectiveQuery = undefined" class="btn btn-default" ng-disabled="!assessmentsFilter.objectiveQuery">
                                                                <span class="glyphicon glyphicon-remove"></span>
                                                              </button>
                                                            </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="assessmentAccordionScroll" autoscroll="{{ 256 + (assessmentsFilter.open?47:0) }}" ng-scroll="floatingScrollListener('assessmentAccordionScroll')">
                                        <div class="container-fluid" ng-if="!class.assessments.length">
                                            <h4 class="text-info">No Assessments</h4>
                                        </div>
                                        <div class="container-fluid" ng-if="class.assessments.length && !filterAssessments().length">
                                            <h4 class="text-info">No results, try adjusting your filters.</h4>
                                        </div>

                                        <uib-accordion close-others="false">
                                            <div uib-accordion-group class="panel-default" ng-repeat="assessment in filterAssessments()" is-open="assessmentOpen[$index]" context-menu="assessmentHeader">
                                                <uib-accordion-heading>
                                                    <div>
                                                        <span ng-bind-html="(assessmentsFilter.open && assessmentsFilter.searchNames)?(assessment.assessmentName|highlight:assessmentsFilter.query:assessmentsFilter.caseSensitive):assessment.assessmentName"></span>
                                                        <span class="badge" ng-bind-html="assessmentTotalQuestions(assessment)"></span>
                                                        <span class="badge" ng-if="assessment.rules.length" style="background-color:lightgrey">
                                                            {{ assessmentBadgeRules(assessment) }}
                                                        </span>
                                                        <span class="badge" ng-if="assessment.questions.length">
                                                            {{ assessmentBadgeQuestions(assessment) }}
                                                        </span><br ng-if="assessment.assessmentDescription"/>
                                                        <small ng-if="assessment.assessmentDescription" ng-bind-html="(assessmentsFilter.open && assessmentsFilter.searchDescriptions)?(assessment.assessmentDescription|highlight:assessmentsFilter.query:assessmentsFilter.caseSensitive):assessment.assessmentDescription">{{ assessment.assessmentDescription }}</small>
                                                    </div>
                                                </uib-accordion-heading>

                                                <div class="btn-group btn-group-sm pull-right" role="group">
                                                    <button type="button" class="btn btn-default" ng-click="editAssessment(assessment.ID)">Edit</button>
                                                    <button type="button" class="btn btn-default" ng-click="exportAssessment(assessment.ID)">Export</button>
                                                </div>

                                                <!-- Rules -->
                                                <strong ng-if="assessment.rules.length">Rules:</strong>
                                                <p style="padding-left:5px" ng-repeat="rule in assessment.rules" bind-html-compile="formatAssessmentRule(rule)"></p>
                                                <!-- Manually Added Questions -->
                                                <strong ng-if="assessment.questions.length">Questions:</strong>
                                                <p style="padding-left:5px" ng-repeat="question in assessment.questions" bind-html-compile="formatAssessmentQuestion(question)"></p>

                                                <!-- No Rules or Questions -->
                                                <p class="text-info" ng-if="!assessment.questions.length && !assessment.rules.length">
                                                    This assessment contains no rules or questions.
                                                </p>
                                            </div>
                                        </uib-accordion>
                                    </div>
                                </div>
                            </uib-tab>
                            <!-- Topics Tab-->
                            <uib-tab index="1" context-menu="topicsHeading">
                                <uib-tab-heading>
                                    Topics  ({{ class.topics.length-1 }})
                                </uib-tab-heading>

                                <div class="tab-pane" style="padding:5px;background:white;border:1px solid #ddd;border-top-color:white;border-radius:0 0 4px 4px">
                                    <div class="container-fluid" style="padding-bottom:5px">
                                        <div id="topicFloatingButtons" style="padding-bottom:5px;">
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-primary" ng-click="createTopic()">Create New</button>
                                                <button type="button" class="btn btn-default" ng-disabled="!class.topics.length" ng-click="iterateAccordion(topicOpen,true,class.topics.length)">Expand All</button>
                                                <button type="button" class="btn btn-default" ng-disabled="!class.topics.length" ng-click="iterateAccordion(topicOpen,false,class.topics.length)">Collapse All</button>
                                            </div>

                                            <div class="btn-group btn-group-sm" style="float:right;position:relative;top:6px">
                                                <button type="button" class="btn btn-default" data-toggle="button" tooltip-placement="left"
                                                        uib-tooltip="{{ 'Sort By: '+topicsSort.name }}" ng-click="incrementSortMode('topicsSort')">
                                                    <span class="glyphicon {{topicsSort.icon}}"></span>
                                                </button>
                                                <button type="button" class="btn btn-default" data-toggle="button"
                                                        tooltip-placement="top" uib-tooltip="Filter" ng-click="topicsFilter.open = !topicsFilter.open">
                                                    <span class="glyphicon glyphicon-filter"></span>
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Filter Dropdown -->
                                        <div ng-if="topicsFilter.open">
                                            <div style="padding: 5px;background-color:#e7e7e7;border:1px solid rgb(205, 205, 205);display:inline-flex;width:100%">
                                                <div class="input-group" style="width:100%">
                                                    <input type="text" class="form-control" placeholder="Filter Topics" ng-model="topicsFilter.query">
                                                    <span class="input-group-addon">
                                                        <label>
                                                            <input type="checkbox" ng-model="topicsFilter.searchTopics" style="position:relative;top:2px"/>
                                                            Search Topics
                                                        </label>
                                                        <label>
                                                            <input type="checkbox" ng-model="topicsFilter.searchDescriptions" style="position:relative;top:2px"/>
                                                            Search Descriptions
                                                        </label>
                                                        <label>
                                                            <input type="checkbox" ng-model="topicsFilter.caseSensitive" style="position:relative;top:2px"/>
                                                            Case Sensitive
                                                        </label>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="topicAccordionScroll" autoscroll="{{ 256 + (topicsFilter.open?47:0) }}" ng-scroll="floatingScrollListener('topicAccordionScroll')">
                                        <div class="container-fluid" ng-if="!class.topics.length">
                                            <h4 class="text-info">No Topics</h4>
                                        </div>
                                        <div class="container-fluid" ng-if="class.topics.length && !filterTopics().length">
                                            <h4 class="text-info">No results, try adjusting your filters.</h4>
                                        </div>

                                        <uib-accordion close-others="false">
                                            <div uib-accordion-group class="panel-default" ng-repeat="topic in (filterTopics()|sort:getSortParams('topics',topicsSort))" is-open="topicOpen[$index]" context-menu="topicHeader">
                                                <uib-accordion-heading>
                                                    <div>
                                                        <span ng-bind-html="(topicsFilter.open && topicsFilter.searchTopics)?(topic.topicName|highlight:topicsFilter.query:topicsFilter.caseSensitive):topic.topicName"></span>
                                                        <span class="badge">
                                                            {{ topicBadge(topic) }}
                                                        </span>
                                                        <span class="badge" ng-if="topic.ID == 0" tooltip-placement="right"
                                                              uib-tooltip="Questions without a set topic will be assigned this topic">
                                                            Default Topic
                                                        </span>
                                                        <br ng-if="topic.topicDescription" />
                                                        <small ng-if="topic.topicDescription" ng-bind-html="(topicsFilter.open && topicsFilter.searchDescriptions)?(topic.topicDescription|highlight:topicsFilter.query:topicsFilter.caseSensitive):topic.topicDescription"></small>
                                                    </div>
                                                </uib-accordion-heading>

                                                <div class="btn-group btn-group-sm pull-right" role="group">
                                                    <button type="button" class="btn btn-default" ng-click="editTopic(topic.ID)">Edit</button>
                                                </div>

                                                <!-- Questions -->
                                                <strong ng-if="topic.questions.length">Questions:</strong>
                                                <p style="padding-left:5px" ng-repeat="question in topic.questions" bind-html-compile="formatQuestion(question)"></p>

                                                <!-- No Questions -->
                                                <p class="text-info" ng-if="!topic.questions.length">
                                                    There are no questions under this topic.
                                                </p>
                                            </div>
                                        </uib-accordion>
                                    </div>
                                </div>
                            </uib-tab>
                            <!-- Objectives Tab -->
                            <uib-tab index="2" context-menu="objectivesHeading">
                                <uib-tab-heading>
                                    Objectives  ({{ class.objectives.length }})
                                </uib-tab-heading>

                                <div class="tab-pane" style="padding:5px;background:white;border:1px solid #ddd;border-top-color:white;border-radius:0 0 4px 4px">
                                    <div class="container-fluid" style="padding-bottom:5px">
                                        <div id="objectiveFloatingButtons" style="padding-bottom:5px;">
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-primary" ng-click="createObjective()">Create New</button>
                                                <button type="button" class="btn btn-default" ng-disabled="!class.objectives.length" ng-click="iterateAccordion(objectiveOpen,true,class.objectives.length)">Expand All</button>
                                                <button type="button" class="btn btn-default" ng-disabled="!class.objectives.length" ng-click="iterateAccordion(objectiveOpen,false,class.objectives.length)">Collapse All</button>
                                            </div>

                                            <div class="btn-group btn-group-sm" style="float:right;position:relative;top:6px">
                                                <button type="button" class="btn btn-default" data-toggle="button" tooltip-placement="left"
                                                        uib-tooltip="{{ 'Sort By: '+objectivesSort.name }}" ng-click="incrementSortMode('objectivesSort')">
                                                    <span class="glyphicon {{objectivesSort.icon}}"></span>
                                                </button>
                                                <button type="button" class="btn btn-default" data-toggle="button"
                                                        tooltip-placement="top" uib-tooltip="Filter" ng-click="objectivesFilter.open = !objectivesFilter.open">
                                                    <span class="glyphicon glyphicon-filter"></span>
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Filter Dropdown -->
                                        <div ng-if="objectivesFilter.open">
                                            <div style="padding: 5px;background-color:#e7e7e7;border:1px solid rgb(205, 205, 205);display:inline-flex;width:100%">
                                                <div class="input-group" style="width:100%">
                                                    <input type="text" class="form-control" placeholder="Filter Objectives" ng-model="objectivesFilter.query">
                                                    <span class="input-group-addon">
                                                        <label>
                                                            <input type="checkbox" ng-model="objectivesFilter.caseSensitive" style="position:relative;top:2px"/>
                                                            Case Sensitive
                                                        </label>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="objectiveAccordionScroll" autoscroll="{{ 256 + (objectivesFilter.open?47:0) }}" ng-scroll="floatingScrollListener('objectiveAccordionScroll')">
                                        <div class="container-fluid" ng-if="!class.objectives.length">
                                            <h4 class="text-info">No Objectives</h4>
                                        </div>
                                        <div class="container-fluid" ng-if="class.objectives.length && !filterObjectives().length">
                                            <h4 class="text-info">No results, try adjusting your filters.</h4>
                                        </div>

                                        <uib-accordion close-others="false">
                                            <div uib-accordion-group class="panel-default" ng-repeat="objective in (filterObjectives()|sort:getSortParams('objectives',objectivesSort))" is-open="objectiveOpen[$index]" context-menu="objectiveHeader">
                                                <uib-accordion-heading>
                                                    <div>
                                                        <span ng-bind-html="objectivesFilter.open?(objective.objectiveText | highlight: objectivesFilter.query:objectivesFilter.caseSensitive):(objective.objectiveText)"></span>
                                                        <span class="badge">
                                                            {{ objectiveBadge(objective) }}
                                                        </span><br/>
                                                    </div>
                                                </uib-accordion-heading>

                                                <div class="btn-group btn-group-sm pull-right" role="group">
                                                    <button type="button" class="btn btn-default" ng-click="editObjective(objective.ID)">Edit</button>
                                                </div>

                                                <!-- Questions -->
                                                <strong ng-if="objective.questionUIDs.length">Questions:</strong>
                                                <p style="padding-left:5px" ng-repeat="questionUID in objective.questionUIDs" bind-html-compile="formatObjectiveQuestion(questionUID)"></p>

                                                <!-- No Questions -->
                                                <p class="text-info" ng-if="!objective.questionUIDs.length">
                                                    There are no questions under this objective.
                                                </p>

                                            </div>
                                        </uib-accordion>
                                    </div>
                                </div>
                            </uib-tab>
                            <!-- Questions Tab -->
                            <uib-tab index="3" context-menu="questionsHeading">
                                <uib-tab-heading>
                                    Questions  ({{ getClassQuestions() }})
                                </uib-tab-heading>

                                <div class="tab-pane" style="padding:5px;background:white;border:1px solid #ddd;border-top-color:white;border-radius:0 0 4px 4px">
                                    <div class="container-fluid" style="padding-bottom:5px">
                                        <div id="questionFloatingButtons" style="padding-bottom:5px;">
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-primary" ng-click="createQuestion()">Create New</button>
                                                <button type="button" class="btn btn-default" ng-disabled="!questionCount" ng-click="iterateAccordion(questionOpen,true,questionCount)">Expand All</button>
                                                <button type="button" class="btn btn-default" ng-disabled="!questionCount" ng-click="iterateAccordion(questionOpen,false,questionCount)">Collapse All</button>
                                            </div>

                                            <div class="btn-group btn-group-sm" style="float:right;position:relative;top:6px">
                                                <button type="button" class="btn btn-default" data-toggle="button" tooltip-placement="left"
                                                        uib-tooltip="{{ 'Sort By: '+questionsSort.name }}" ng-click="incrementSortMode('questionsSort')">
                                                    <span class="glyphicon {{questionsSort.icon}}"></span>
                                                </button>
                                                <button type="button" class="btn btn-default" data-toggle="button"
                                                        tooltip-placement="top" uib-tooltip="Filter" ng-click="questionsFilter.open = !questionsFilter.open">
                                                    <span class="glyphicon glyphicon-filter"></span>
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Filter Dropdown -->
                                        <div ng-if="questionsFilter.open">
                                            <div style="padding: 5px;background-color:#e7e7e7;border:1px solid rgb(205, 205, 205);display:inline-flex">
                                                <div class="input-group" style="width:65%;margin-right:2px">
                                                    <input type="text" class="form-control" placeholder="Filter Questions" ng-model="questionsFilter.query">
                                                    <span class="input-group-addon">
                                                        <label>
                                                            <input type="checkbox" ng-model="questionsFilter.searchQuestions" style="position:relative;top:2px"/>
                                                            Search Questions
                                                        </label>

                                                        <label>
                                                            <input type="checkbox" ng-model="questionsFilter.searchDescriptions" style="position:relative;top:2px"/>
                                                            Search Descriptions
                                                        </label>

                                                        <label>
                                                            <input type="checkbox" ng-model="questionsFilter.searchAnswers" style="position:relative;top:2px"/>
                                                            Search Answers
                                                        </label>

                                                        <label>
                                                            <input type="checkbox" ng-model="questionsFilter.caseSensitive" style="position:relative;top:2px"/>
                                                            Case Sensitive
                                                        </label>
                                                    </span>
                                                </div>
                                                <div style="width:35%; display:inherit">
                                                    <div class="input-group" style="width:50%;margin-right:2px">
                                                        <ui-select allow-clear ng-model="questionsFilter.topicQuery" theme="bootstrap">
                                                            <ui-select-match placeholder="Filter Topic">
                                                                {{$select.selected.topicName}}
                                                            </ui-select-match>
                                                            <ui-select-choices repeat="topic in class.topics | filter: { topicName: $select.search }">
                                                                <div ng-bind-html="topic.topicName | highlight: $select.search"></div>
                                                                <small class="text-muted" ng-bind-html="topic.topicDescription"></small>
                                                            </ui-select-choices>
                                                        </ui-select>
                                                        <span class="input-group-btn">
                                                          <button type="button" ng-click="questionsFilter.topicQuery = undefined" class="btn btn-default" ng-disabled="!questionsFilter.topicQuery">
                                                            <span class="glyphicon glyphicon-remove"></span>
                                                          </button>
                                                        </span>
                                                    </div>
                                                    <div class="input-group" style="width:50%">
                                                        <ui-select ng-model="questionsFilter.objectiveQuery" theme="bootstrap" ng-disabled="!class.objectives.length">
                                                            <ui-select-match placeholder="Filter Objective">
                                                                {{$select.selected.objectiveText}}
                                                            </ui-select-match>
                                                            <ui-select-choices repeat="objective in class.objectives | filter: { objectiveText: $select.search }">
                                                                <span ng-bind-html="objective.objectiveText | highlight: $select.search"></span>
                                                            </ui-select-choices>
                                                        </ui-select>
                                                        <span class="input-group-btn">
                                                          <button type="button" ng-click="questionsFilter.objectiveQuery = undefined" class="btn btn-default" ng-disabled="!questionsFilter.objectiveQuery">
                                                            <span class="glyphicon glyphicon-remove"></span>
                                                          </button>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="questionAccordionScroll" autoscroll="{{ 256 + (questionsFilter.open?47:0) }}" ng-scroll="floatingScrollListener('questionAccordionScroll')"
                                         style="margin: 0 5px 0 5px">
                                        <div class="container-fluid" ng-if="!questionCount">
                                            <h4 class="text-info">No Questions</h4>
                                        </div>
                                        <div class="container-fluid" ng-if="questionCount && !filterQuestions().length">
                                            <h4 class="text-info">No results, try adjusting your filters.</h4>
                                        </div>

                                        <uib-accordion close-others="false">
                                            <div uib-accordion-group class="panel-default" ng-repeat="question in (filterQuestions()|sort:getSortParams('questions',questionsSort))" is-open="questionOpen[$index]" context-menu="questionHeader">
                                                <uib-accordion-heading>
                                                    <div>
                                                        <span ng-bind-html="(questionsFilter.searchQuestions && questionsFilter.open)?(question.questionTitle | highlight: questionsFilter.query:questionsFilter.caseSensitive):(question.questionTitle)"></span>
                                                        <span class="badge" ng-if="question.topicID != 0">
                                                            {{ questionBadgeTopic(question) }}
                                                        </span>
                                                        <span class="badge" ng-if="question.objectives.length">
                                                            {{ questionBadgeObjectives(question) }}
                                                        </span><br ng-if="question.questionDescription"/>
                                                        <small ng-if="question.questionDescription" ng-bind-html="(questionsFilter.searchDescriptions && questionsFilter.open)?(question.questionDescription | highlight: questionsFilter.query:questionsFilter.caseSensitive):(question.questionDescription)"></small>
                                                    </div>
                                                </uib-accordion-heading>

                                                <div class="btn-group btn-group-sm pull-right" role="group">
                                                    <button type="button" class="btn btn-default" ng-click="editQuestion(question.UID)">Edit</button>
                                                </div>

                                                <!-- Question Topic and Objectives -->
                                                <p bind-html-compile="formatQuestionTopicObjectives(question)"></p>

                                                <!-- Question Type -->
                                                <strong bind-html-compile="formatQuestionType(question)"></strong>

                                                <!-- Answers -->
                                                <p style="padding-left:5px" ng-if="question.answers" ng-bind-html="formatQuestionAnswers(question)"></p>

                                                <!-- No Answers -->
                                                <p class="text-info" ng-if="!question.answers">
                                                    This question has no answers.
                                                </p>
                                            </div>
                                        </uib-accordion>
                                    </div>
                                </div>
                            </uib-tab>
                        </uib-tabset>
                    </md-content>
                </div>
            </md-tab>
            <md-tab ng-repeat="tab in tabs" label="{{ tab.name }}">
                <md-content class="md-padding greyBackground">
                    <div ng-include="tab.URL" dynamic-ctrl="tab.controller"
                         ng-init="tabID=tab.id;tabData=tab.data;requestFocus()"></div>
                </md-content>
            </md-tab>
        </md-tabs>
    </md-content>

</div>